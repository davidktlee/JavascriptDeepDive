# 생성자 함수에 의한 객체 생성

## Object 생성자 함수

new 연산자와 함께 object 생성자 함수를 호출하면 빈 객체를 생성하여 반환.

생성자 함수란?

new 연산자와 함께 호출해 객체(인스턴스)를 생성하는 함수를 말한다.

**생성자 함수에 의해 만들어진 객체를 인스턴스라 한다.**

### 생성자 함수를 사용하는 이유

생성자 함수 말고도 객체를 생성할 수 있는 방법은 여러가지가 있다.

그 중 객체 리터럴 생성 방식은 간단하고 직관적이지만 여러 개의 객체를 생성해야 할 때
하드 코딩이 되기 때문에 비효율적이다.

생성자 함수에 의한 객체 생성 방식의 장점은 생성자 함수를 사용하여 프로퍼티 구조가 동일한
객체 여러 개를 간편하게 생성할 수 있다.

```ts
interface Diameter {
  (): number
}

interface MyCircle {
  (radius: number): void
}

function Circle: MyCircle(radius: number) {
  this.radius = radius

  this.getDiameter:Diameter = function () {
    return 2 * this.radius
  }
}
const Circle1 = new Circle(5)
console.log(Circle1) // 10
```

> this 부분은 뒤에서 여기서는 다루기에 다루지 않겠습니다.

## 생성자 함수의 인스턴스 생성 과정

1. 인스턴스 생성과 this 바인딩<br>
   런타임 이전에 암묵적으로 빈 객체가 생성되고 this에 바인딩된다.

> 바인딩이란? <br>
> 식별자와 값을 연결하는 과정, this 바인딩은 this가 가리킬 객체를 바인딩하는 것이다.

2. 인스턴스 초기화 <br>
   코드가 실행되며 this에 바인딩 되어있는 인스턴스에 프로퍼티나 메서드를 추가하고 생성자 함수가 인수로 전달받은 초기값을 인스턴스 프로퍼티에 할당하여 초기화하거나 고정값을 할당한다.<br>
   이 부분은 개발자가 작성.

3. 인스턴스 반환 <br>
   생성자 함수 내부의 모든 처리가 끝나면 완성된 인스턴스가 바인딩된 this가 암묵적으로 반환된다. <br>
   this가 아닌 다른 객체를 명시적으로 반환하면 this가 반환되지 못하기 때문에 return 문을 반드시 생략해야 한다.

## 내부 메서드 `[[Call]]` 과 `[[Construct]]`

함수는 객체이지만 일반 객체와는 다르게 함수로서 동작 하기 위해 여러 내부 슬롯과 `[[Call]]`, `[[Contruct]]` 와 같은 내부 메서드를 추가로 가지고 있다.

**함수가 일반 함수로서 호출되면 내부 메서드 `[[Call]]`이 호출되고 생성자 함수로서 호출되면 `[[Construct]]`가 호출된다.**

모든 함수가 `[[Contruct]]` 메서드를 갖는 것은 아니며 **함수 선언문, 함수 표현식, 클래스** 는 **constructor** (내부 메서드 `[[Contruct]]`를 가짐)
<br>
**ES6메서드, 화살표 함수** 는 \*\* **non-constructor** 이다.

### new 연산자

new 연산자와 함께 호출하는 함수는 **constructor** 이어야 한다.

### new.target

생성자 함수로 호출해야 하는데 일반 함수로 호출하게 된다면 원하는 결과가 나오지 않을 수 있기 때문에 `new.target` 을 사용한다.

함수 내부의 `new.target` 은 생성자 함수로서 호출 된다면 함수 자신을 가리키고 일반 함수로 호출된다면 `undefined` 가 나온다.

그래서 조건문으로 `new.target` 의 결과가 `undefined` 라면 생성자 함수로 호출할 수 있게 만들 수 있다.